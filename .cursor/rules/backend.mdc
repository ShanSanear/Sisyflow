---
description: 
globs: src/db/*.ts,src/middleware/*.ts,src/lib/*.ts
alwaysApply: false
---
### Backend and Database

- Use Supabase for backend services, including authentication and database interactions.
- Follow Supabase guidelines for security and performance.
- Use Zod schemas to validate data exchanged with the backend.
- Use supabase from context.locals in Astro routes instead of importing supabaseClient directly
- Use use createSupabaseServerInstance function from `src/db/supabase.client.ts` to create SupabaseClient instance, DO NOT export it from `@supabase/supabase-js`
- For Supabase errors use appropriate framework in src/lib/utils.ts
- Always check src/lib/utils.ts for useful functions before commiting any work, to not repeat it
